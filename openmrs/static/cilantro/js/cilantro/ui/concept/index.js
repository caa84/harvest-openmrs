define(["backbone","../core","../base","../accordian"],function(e,t,i,n){var r=n.Item.extend({events:{"click a":"click"},initialize:function(){this.listenTo(t,t.CONCEPT_FOCUS,this.toggleFocus)},click:function(e){e.preventDefault(),t.trigger(t.CONCEPT_FOCUS,this.model.id)},toggleFocus:function(e){this.$el.toggleClass("active",e===this.model.id)}}),o=n.Section.extend({itemView:r,filter:function(e,t){var i=!1;return this.children.each(function(n){!e||t[n.model.id]?(n.$el.show(),i=!0):n.$el.hide()}),this.$el.toggle(i),i}}),c=n.Group.extend({itemView:o,filter:function(e,t){var i=!1;return this.children.each(function(n){n.filter(e,t)&&(i=!0)}),e?i?(this.$el.show(),this.renderExpanded()):this.$el.hide():(this.$el.show(),this.renderState()),i},find:function(e){var t,i,n;for(t in this.children._views)if(i=this.children._views[t],i.children&&(n=i.children.findByModel(e)))return n}}),s=n.Accordian.extend({className:"concept-index accordian",itemView:c,emptySearchView:i.EmptySearchView,showCollection:function(){this.resetGroups();var e=this;this.groups.each(function(t,i){e.addItemView(t,e.getItemView(t),i)})},getGroup:function(e){if(e.category){for(var t=e.category;t.parent;)t=t.parent;return t}return{id:-1,name:"Other"}},getSection:function(e){return e.category&&e.category.parent?e.category:{id:-1,name:"Other"}},resetGroups:function(){this.groups?this.groups.reset():this.groups=new e.Collection(null,{comparator:"order"});var t=this;this.collection.each(function(e){t.groupModel(e)})},groupModel:function(t){var i=this.getGroup(t.attributes),n=this.getSection(t.attributes),r=this.groups.get(i.id);r||(r=new e.Model(i),r.sections=new e.Collection(null,{comparator:"order"}),this.groups.add(r));var o=r.sections.get(n.id);o||(o=new e.Model(n),o.items=new e.Collection(null,{comparator:"order"}),r.sections.add(o)),o.items.add(t)},filter:function(e,t){var i={};if(e){var n,r,o;for(n=0;n<t.length;n++)r=t[n],(o=this.collection.get(r.id))&&(i[o.id]=o)}var c=!1;return this.children.each(function(t){t.filter(e,i)&&(c=!0)}),c?this.closeEmptySearchView():this.showEmptySearchView(e),c},find:function(e){var t,i,n;for(t in this.children._views)if(i=this.children._views[t],n=i.find(e))return n},showEmptySearchView:function(e){this.closeEmptySearchView(),this._emptyView=new this.emptySearchView({message:'<p>We could not find anything related to "'+e+'"</p>'}),this.$el.append(this._emptyView.render().el)},closeEmptySearchView:function(){this._emptyView&&(this._emptyView.remove(),delete this._emptyView)}});return{ConceptIndex:s,ConceptGroup:c,ConceptSection:o,ConceptItem:r}});
//# sourceMappingURL=index.js.map